MICS6 - 10 - WS.1.1
================
Reid Minto
March 25, 2020

# Load libraries

``` r
library(tidyverse); library(haven); library(lubridate);
library(knitr); library(kableExtra)
library(Hmisc); library(survey)
library(expss); library(here); library(gmodels)
library(flextable); library(formattable)
library(prettydoc)

library(tableone); library(sjPlot); library(srvyr)
```

# Import data

`here` function navigates you to top level Rproj directory

``` r
# haven library called above has read_sav function for reading in .sav / .sps etc
# files from other languages
here()
```

    ## [1] "C:/Users/Owner/Documents/UNICEF-MICS"

``` r
hh <- read_sav(here("Data/Tunisia_hh.sav"))
# hh <- as_factor(hh, only_labelled = TRUE)
```

Filter only cases where hh interview = 1, create a variable
`hhweightHH48` by multiplying `HH48` and `hhweight`, number of hh
members by sample weight

Note: this is just first pass rough draft / run through - much of this
looks like it can be consolidated into a single chunk / a single
function execute per section from what I’ve seen so far, but broken up
in first pass

# 10 - WS.1.1

``` r
hh <- hh %>% filter(HH46 == 1) %>% 
  mutate(hhweightHH48 = HH48 * hhweight) %>% mutate(nhhmem = 1 * hhweightHH48)

hh <- hh %>% 
  apply_labels(nhhmem = "Number of household members")

val_lab(hh$nhhmem) = make_labels("
    11 ROBINET: DANS LE LOGEMENT
    12 ROBINET: DANS LA CONCESSION/JARDIN/ PARCELLE
    13 ROBINET: CHEZ LE VOISIN
    14 ROBINET: ROBIENT PUBLIC/BORNE FONTAINE
    21 PUITS A POMPE/FORAGE
    31 PUITS CREUSE: PROTEGE
    32 PUITS CREUSE: PAS PROTEGE
    41 SOURCE: SOURCE PROTEGEE
    42 SOURCE: SOURCE NON PROTEGEE
    51 EAU DE PLUIE
    61 CAMION CITERNE
    71 CHARRETTE AVEC PETITE CITERNE
    81 EAU DE SURFACE (RIVIERE, BARRAGE, LAC, MARE, COURANT, CANAL, SYSTEME D’IRRIGATION)
    91 EAU CONDITIONNEE: EAU EN BOUTEILLE
    92 EAU CONDITIONNEE: EAU EN SACHET
    96 AUTRE
    99 NON REPONSE
                                 ")
############   Begin 10 - WS.sps   ############################

hh <- hh %>% 
  mutate(drinkingWater = ifelse(WS1 %in% c(11:14, 21, 31, 41, 51, 61, 71, 72, 91, 92), 1, 2))

var_lab(hh$drinkingWater) = "Main source of drinking water"
val_lab(hh$drinkingWater) = make_labels("
  1 Improved sources
  2 Unimproved sources
")



hh <- hh %>% 
  mutate(toiletType = case_when(
    WS11 %in% c(11:13, 18, 21, 22, 31) ~ 1,
    WS11 == 95 ~ 3,
    TRUE ~ 2
  ))


var_lab(hh$toiletType) = "Type of sanitation facility"
val_lab(hh$toiletType) = make_labels("
    1 Improved
    2 Unimproved
    3 Open defecation (no facility, bush, field)
                                     ")


hh <- hh %>% mutate(flush = NA) %>% mutate(flush = case_when(
  WS11 %in% c(1:14, 18) ~ 1
))

var_lab(hh$flush) = ""; val_lab(hh$flush) = make_labels(" 
                                                        1 Flush/Pour flush to:
                                                        ")



hh <- hh %>% mutate(sharedToilet = case_when(
  WS17 %in% c(1:5) ~ 1,
  WS17 %in% 97:99 ~ 9,
  NA ~ 0,
  TRUE ~ 2
))

hh <- hh %>% mutate(sharedToilet = ifelse(WS16 == 2, 3, sharedToilet))

var_lab(hh$sharedToilet) = " "
val_lab(hh$sharedToilet) = make_labels("
  0 Not shared
  1 5 households or less
  2 More than 5 households
  3 Public facility
  9 DK/Missing
                                       ")


############   End 10 - WS.sps   ############################


hh <- hh %>% mutate(improvedWater = ifelse(drinkingWater == 1, 100, 0)) 


var_lab(hh$improvedWater) = "Percentage using improved sources of drinking water [1]"
var_lab(hh$WS1) = ""


hh <- hh %>% mutate(total = 1, total100 = 100)
var_lab(hh$total) = "Total"; var_lab(hh$total100) = "Total"
val_lab(hh$total) = make_labels(" 
                                  1
                                ")
val_lab(hh$total100) = make_labels("
                                   100
                                   ")
```

Experimenting with packages, structures, table aesthetics

``` r
hh.tab <- hh %>% 
  mutate(nn = nhhmem * hhweightHH48) %>% 
  select(WS1, HH6, HH7, helevel, windex5, drinkingWater, total100, total, improvedWater, 
         nhhmem, nn)

# convert sps labels to factor labels in r
hh.tab = as_factor(hh.tab, only_labelled = TRUE)
hh = hh %>% mutate(nn = nhhmem * hhweightHH48)

tab.total = hh %>% tally(nn, name = "Count")

tab = tab.total %>% 
  rbind.data.frame(
    hh.tab %>% group_by(HH6) %>% tally(nn, name = "Count") %>% select(Count),
    hh.tab %>% group_by(HH7) %>% tally(nn, name = "Count") %>% select(Count),
    hh.tab %>% group_by(helevel) %>% tally(nn, name = "Count") %>% select(Count),
    hh.tab %>% group_by(windex5) %>% tally(nn, name = "Count") %>% select(Count)
  ) %>% data.frame()


row.names(tab) = c("Total", levels(hh.tab$HH6), levels(hh.tab$HH7), 
                   levels(hh.tab$helevel), levels(hh.tab$windex5))


#kable(tab, digits = 0) %>% 
#  kable_styling("striped") %>% 
#  pack_rows("Total", 1, 1) %>% 
#  pack_rows(label(hh.tab$HH6), 2, 3) %>% 
#  pack_rows(label(hh.tab$HH7), 4, 10) %>% 
#  pack_rows(label(hh.tab$helevel), 11, 15) %>% 
#  pack_rows(label(hh.tab$windex5), 16, 20)



N <- tab$Count
df.tab = data.frame(tab)
```

# 10.1.1 Table

``` r
tab.1.1 = xtabs(nhhmem ~ WS1, hh) %>% 
  rbind(xtabs(nhhmem ~ as_factor(HH6) + WS1, hh)) %>% 
  rbind(xtabs(nhhmem ~ as_factor(HH7) + WS1, hh)) %>%
  rbind(xtabs(nhhmem ~ as_factor(helevel) + WS1, hh)) %>% 
  rbind(xtabs(nhhmem ~ as_factor(windex5) + WS1, hh))


tab.improved = xtabs(nhhmem ~ improvedWater, hh) %>% 
  rbind(xtabs(nhhmem ~ as_factor(HH6) + improvedWater, hh)) %>% 
  rbind(xtabs(nhhmem ~ as_factor(HH7) + improvedWater, hh)) %>%
  rbind(xtabs(nhhmem ~ as_factor(helevel) + improvedWater, hh)) %>% 
  rbind(xtabs(nhhmem ~ as_factor(windex5) + improvedWater, hh))


tab.1.1 = tab.1.1 %>%
  cbind(Total = rowSums(tab.1.1)) %>% 
  cbind(tab.improved[, 2])

N = round(tab.1.1[ , 17])

colnames(tab.1.1)[18] = "Percentage using drinking water from improved sources"



#labels(tabf)[[1]][1] = "Total"
tab.1.1 = apply(tab.1.1, 2, function(x) (x*100) / tab.1.1[, 17])

tab.1.1 <- tab.1.1 %>% cbind(N); colnames(tab.1.1)[18:19] = c("Pourcen-tage utilisant de l'eau de boisson de sources améliorées1", "Nombre de membres des ménages ")

rownames(tab.1.1)[1] = "Total"





# columns are labeled incorrectly 
# SPSS syntax does not match table output, even though I get correct results, they are nested in 
# incorrect value labels / label hierarchies, can fix this as I go, need to investigate though

ind <- c(1, 2, 3, 4, 5, 6, 8, 10, 11, 12, 14, 15, 7, 9, 13, 16, 17)

tab.1.1[ , 1:17] = tab.1.1[ , ind]
```

# SFR Table Ch10 WS 1.1

<table class="table table-striped" style="font-size: 12px; margin-left: auto; margin-right: auto;">

<thead>

<tr>

<th style="border-bottom:hidden" colspan="1">

</th>

<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="19">

<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">

Source principale d’eau de boisson

</div>

</th>

</tr>

<tr>

<th style="border-bottom:hidden" colspan="1">

</th>

<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="12">

<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">

Sources améliorées

</div>

</th>

<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">

<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">

Sources non améliorées

</div>

</th>

<th style="border-bottom:hidden" colspan="3">

</th>

</tr>

<tr>

<th style="border-bottom:hidden" colspan="1">

</th>

<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">

<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">

Eau courante

</div>

</th>

<th style="border-bottom:hidden" colspan="15">

</th>

</tr>

<tr>

<th style="text-align:left;">

</th>

<th style="text-align:right;">

ROBINET: DANS LE LOGEMENT

</th>

<th style="text-align:right;">

ROBINET: DANS LA CONCESSION/JARDIN/ PARCELLE

</th>

<th style="text-align:right;">

ROBINET: CHEZ LE VOISIN

</th>

<th style="text-align:right;">

ROBINET: ROBIENT PUBLIC/BORNE FONTAINE

</th>

<th style="text-align:right;">

PUITS A POMPE/FORAGE

</th>

<th style="text-align:right;">

PUITS CREUSE: PROTEGE

</th>

<th style="text-align:right;">

PUITS CREUSE: PAS PROTEGE

</th>

<th style="text-align:right;">

SOURCE: SOURCE PROTEGEE

</th>

<th style="text-align:right;">

SOURCE: SOURCE NON PROTEGEE

</th>

<th style="text-align:right;">

EAU DE PLUIE

</th>

<th style="text-align:right;">

CAMION CITERNE

</th>

<th style="text-align:right;">

CHARRETTE AVEC PETITE CITERNE

</th>

<th style="text-align:right;">

EAU DE SURFACE (RIVIERE, BARRAGE, LAC, MARE, COURANT, CANAL, SYSTEME
D’IRRIGATION)

</th>

<th style="text-align:right;">

EAU CONDITIONNEE: EAU EN BOUTEILLE

</th>

<th style="text-align:right;">

EAU CONDITIONNEE: EAU EN SACHET

</th>

<th style="text-align:right;">

AUTRE

</th>

<th style="text-align:right;">

Total

</th>

<th style="text-align:right;">

Pourcen-tage utilisant de l’eau de boisson de sources améliorées1

</th>

<th style="text-align:right;">

Nombre de membres des ménages

</th>

</tr>

</thead>

<tbody>

<tr>

<td style="text-align:left;">

Total

</td>

<td style="text-align:right;">

39.1

</td>

<td style="text-align:right;">

2.4

</td>

<td style="text-align:right;">

0.5

</td>

<td style="text-align:right;">

1.5

</td>

<td style="text-align:right;">

1.1

</td>

<td style="text-align:right;">

2.2

</td>

<td style="text-align:right;">

1.3

</td>

<td style="text-align:right;">

11.4

</td>

<td style="text-align:right;">

2.6

</td>

<td style="text-align:right;">

11.1

</td>

<td style="text-align:right;">

24.6

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.5

</td>

<td style="text-align:right;">

0.6

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.8

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

98.0

</td>

<td style="text-align:right;">

43,638

</td>

</tr>

<tr grouplength="2">

<td colspan="20" style="border-bottom: 1px solid;">

<strong>Area</strong>

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

URBAIN

</td>

<td style="text-align:right;">

38.6

</td>

<td style="text-align:right;">

0.5

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.4

</td>

<td style="text-align:right;">

0.8

</td>

<td style="text-align:right;">

0.6

</td>

<td style="text-align:right;">

9.2

</td>

<td style="text-align:right;">

2.1

</td>

<td style="text-align:right;">

12.6

</td>

<td style="text-align:right;">

33.4

</td>

<td style="text-align:right;">

0.3

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.9

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

99.0

</td>

<td style="text-align:right;">

29,853

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

RURAL

</td>

<td style="text-align:right;">

40.0

</td>

<td style="text-align:right;">

6.6

</td>

<td style="text-align:right;">

1.1

</td>

<td style="text-align:right;">

4.5

</td>

<td style="text-align:right;">

2.6

</td>

<td style="text-align:right;">

5.3

</td>

<td style="text-align:right;">

2.7

</td>

<td style="text-align:right;">

16.4

</td>

<td style="text-align:right;">

3.7

</td>

<td style="text-align:right;">

7.7

</td>

<td style="text-align:right;">

5.4

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

1.5

</td>

<td style="text-align:right;">

1.7

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.7

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

95.9

</td>

<td style="text-align:right;">

13,785

</td>

</tr>

<tr grouplength="7">

<td colspan="20" style="border-bottom: 1px solid;">

<strong>Region</strong>

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

DISTRICT TUNIS

</td>

<td style="text-align:right;">

32.6

</td>

<td style="text-align:right;">

0.7

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.3

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

1.9

</td>

<td style="text-align:right;">

15.6

</td>

<td style="text-align:right;">

47.0

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

1.2

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

98.8

</td>

<td style="text-align:right;">

10,398

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

NORD EST

</td>

<td style="text-align:right;">

44.5

</td>

<td style="text-align:right;">

1.7

</td>

<td style="text-align:right;">

0.3

</td>

<td style="text-align:right;">

0.5

</td>

<td style="text-align:right;">

1.1

</td>

<td style="text-align:right;">

2.0

</td>

<td style="text-align:right;">

1.3

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

25.2

</td>

<td style="text-align:right;">

22.1

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.4

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.3

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

99.2

</td>

<td style="text-align:right;">

6,146

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

NORD OUEST

</td>

<td style="text-align:right;">

55.8

</td>

<td style="text-align:right;">

3.9

</td>

<td style="text-align:right;">

1.5

</td>

<td style="text-align:right;">

6.0

</td>

<td style="text-align:right;">

0.4

</td>

<td style="text-align:right;">

0.7

</td>

<td style="text-align:right;">

9.2

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.3

</td>

<td style="text-align:right;">

3.8

</td>

<td style="text-align:right;">

11.4

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

1.4

</td>

<td style="text-align:right;">

5.2

</td>

<td style="text-align:right;">

0.3

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

93.2

</td>

<td style="text-align:right;">

4,777

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

CENTRE EST

</td>

<td style="text-align:right;">

34.2

</td>

<td style="text-align:right;">

3.3

</td>

<td style="text-align:right;">

0.6

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.7

</td>

<td style="text-align:right;">

0.4

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

28.3

</td>

<td style="text-align:right;">

2.4

</td>

<td style="text-align:right;">

0.7

</td>

<td style="text-align:right;">

27.3

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

1.5

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

98.5

</td>

<td style="text-align:right;">

10,289

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

CENTRE OUEST

</td>

<td style="text-align:right;">

49.3

</td>

<td style="text-align:right;">

5.2

</td>

<td style="text-align:right;">

0.6

</td>

<td style="text-align:right;">

5.6

</td>

<td style="text-align:right;">

5.2

</td>

<td style="text-align:right;">

8.2

</td>

<td style="text-align:right;">

0.4

</td>

<td style="text-align:right;">

3.3

</td>

<td style="text-align:right;">

6.3

</td>

<td style="text-align:right;">

7.6

</td>

<td style="text-align:right;">

6.1

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

1.1

</td>

<td style="text-align:right;">

0.3

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.8

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

97.8

</td>

<td style="text-align:right;">

5,584

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

SUD EST

</td>

<td style="text-align:right;">

25.6

</td>

<td style="text-align:right;">

1.5

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.4

</td>

<td style="text-align:right;">

5.6

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

47.0

</td>

<td style="text-align:right;">

1.1

</td>

<td style="text-align:right;">

3.9

</td>

<td style="text-align:right;">

14.3

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

99.7

</td>

<td style="text-align:right;">

3,957

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

SUD OUEST

</td>

<td style="text-align:right;">

39.3

</td>

<td style="text-align:right;">

0.5

</td>

<td style="text-align:right;">

0.3

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.3

</td>

<td style="text-align:right;">

2.2

</td>

<td style="text-align:right;">

0.8

</td>

<td style="text-align:right;">

1.1

</td>

<td style="text-align:right;">

10.7

</td>

<td style="text-align:right;">

33.2

</td>

<td style="text-align:right;">

8.7

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

2.4

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.4

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

97.1

</td>

<td style="text-align:right;">

2,486

</td>

</tr>

<tr grouplength="5">

<td colspan="20" style="border-bottom: 1px solid;">

<strong>Education of household head</strong>

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Pre-primary or none

</td>

<td style="text-align:right;">

46.6

</td>

<td style="text-align:right;">

4.7

</td>

<td style="text-align:right;">

0.9

</td>

<td style="text-align:right;">

3.1

</td>

<td style="text-align:right;">

1.3

</td>

<td style="text-align:right;">

3.0

</td>

<td style="text-align:right;">

2.6

</td>

<td style="text-align:right;">

9.4

</td>

<td style="text-align:right;">

3.9

</td>

<td style="text-align:right;">

10.6

</td>

<td style="text-align:right;">

9.8

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

1.4

</td>

<td style="text-align:right;">

1.5

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.8

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

96.2

</td>

<td style="text-align:right;">

7,899

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Primary

</td>

<td style="text-align:right;">

43.8

</td>

<td style="text-align:right;">

3.2

</td>

<td style="text-align:right;">

0.8

</td>

<td style="text-align:right;">

1.9

</td>

<td style="text-align:right;">

1.6

</td>

<td style="text-align:right;">

3.0

</td>

<td style="text-align:right;">

1.4

</td>

<td style="text-align:right;">

13.1

</td>

<td style="text-align:right;">

2.8

</td>

<td style="text-align:right;">

12.2

</td>

<td style="text-align:right;">

14.0

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.5

</td>

<td style="text-align:right;">

0.7

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.9

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

97.9

</td>

<td style="text-align:right;">

16,191

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Secondary

</td>

<td style="text-align:right;">

36.1

</td>

<td style="text-align:right;">

1.1

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.6

</td>

<td style="text-align:right;">

0.7

</td>

<td style="text-align:right;">

1.5

</td>

<td style="text-align:right;">

0.8

</td>

<td style="text-align:right;">

11.1

</td>

<td style="text-align:right;">

2.0

</td>

<td style="text-align:right;">

11.9

</td>

<td style="text-align:right;">

32.5

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.8

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

98.8

</td>

<td style="text-align:right;">

14,179

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Higher

</td>

<td style="text-align:right;">

20.9

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.4

</td>

<td style="text-align:right;">

0.7

</td>

<td style="text-align:right;">

0.4

</td>

<td style="text-align:right;">

10.4

</td>

<td style="text-align:right;">

1.4

</td>

<td style="text-align:right;">

6.2

</td>

<td style="text-align:right;">

57.9

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.7

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

99.0

</td>

<td style="text-align:right;">

5,294

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Missing/DK

</td>

<td style="text-align:right;">

62.5

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

18.1

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

2.1

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

17.4

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

100.0

</td>

<td style="text-align:right;">

75

</td>

</tr>

<tr grouplength="5">

<td colspan="20" style="border-bottom: 1px solid;">

<strong>Wealth index quintile</strong>

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Poorest

</td>

<td style="text-align:right;">

28.7

</td>

<td style="text-align:right;">

8.9

</td>

<td style="text-align:right;">

1.8

</td>

<td style="text-align:right;">

7.0

</td>

<td style="text-align:right;">

4.1

</td>

<td style="text-align:right;">

7.4

</td>

<td style="text-align:right;">

4.0

</td>

<td style="text-align:right;">

20.7

</td>

<td style="text-align:right;">

3.9

</td>

<td style="text-align:right;">

6.0

</td>

<td style="text-align:right;">

1.9

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

2.2

</td>

<td style="text-align:right;">

2.6

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.6

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

94.3

</td>

<td style="text-align:right;">

8,728

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Second

</td>

<td style="text-align:right;">

47.7

</td>

<td style="text-align:right;">

2.6

</td>

<td style="text-align:right;">

0.7

</td>

<td style="text-align:right;">

0.6

</td>

<td style="text-align:right;">

0.8

</td>

<td style="text-align:right;">

2.9

</td>

<td style="text-align:right;">

1.5

</td>

<td style="text-align:right;">

24.0

</td>

<td style="text-align:right;">

2.5

</td>

<td style="text-align:right;">

11.0

</td>

<td style="text-align:right;">

4.4

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.6

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

98.9

</td>

<td style="text-align:right;">

8,727

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Middle

</td>

<td style="text-align:right;">

56.3

</td>

<td style="text-align:right;">

0.4

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.5

</td>

<td style="text-align:right;">

0.7

</td>

<td style="text-align:right;">

0.8

</td>

<td style="text-align:right;">

9.1

</td>

<td style="text-align:right;">

2.3

</td>

<td style="text-align:right;">

15.6

</td>

<td style="text-align:right;">

13.1

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.8

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

98.9

</td>

<td style="text-align:right;">

8,726

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Fourth

</td>

<td style="text-align:right;">

45.2

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

2.7

</td>

<td style="text-align:right;">

2.7

</td>

<td style="text-align:right;">

15.3

</td>

<td style="text-align:right;">

32.2

</td>

<td style="text-align:right;">

0.4

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

1.2

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

98.8

</td>

<td style="text-align:right;">

8,731

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Richest

</td>

<td style="text-align:right;">

17.5

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.2

</td>

<td style="text-align:right;">

0.7

</td>

<td style="text-align:right;">

1.4

</td>

<td style="text-align:right;">

7.6

</td>

<td style="text-align:right;">

71.3

</td>

<td style="text-align:right;">

0.3

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0.9

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

99.1

</td>

<td style="text-align:right;">

8,725

</td>

</tr>

</tbody>

</table>

# 10 - WS.1.2

Recode WS4

Odd that 1.2 syntax file has variable label for drinkingWater exact same
as time var label….

``` r
hh <- hh %>% 
  mutate(
    time = case_when(
    WS4 == 0 ~ 2,
    WS4 %in% 1:30 ~ 2,
    WS4 %in% 31:990 ~ 3,
    WS4 %in% 998:999 ~ 9)) %>% 
  mutate(
    time = case_when(
      WS1 %in% 11:13 | WS2 %in% 11:13 | WS3 %in% 1:2 ~ 1
    )
  ) %>% 
  mutate(INDWS2 = 0) %>% 
  mutate(INDWS2 = case_when(
    WS1 %in% c(11, 12) ~ 100,
    WS1 %in% c(61, 71, 72) & WS4 <= 30 ~ 100,
    WS1 %in% c(13, 14, 21, 31, 41, 51) & WS3 %in% 1:2 | WS4 <= 30 ~ 100,
    WS1 %in% 91:92 & WS2 %in% 11:12 ~ 100,
    WS1 %in% 91:92 & (WS2 %in% c(61, 71, 72) & WS4 <= 30) ~ 100,
    WS1 %in% 91:92 & WS2 %in% c(13, 14, 21, 31, 41, 51) & 
      (WS3 %in% 1:2 | WS4 <= 30) ~ 100
  )  )
```

## 10.1.2 Labels

``` r
hh <- hh %>% 
  apply_labels(
    time = "Time to source of drinking water",
    time = c(
      "Water on premises" = 1,
      "Up to and including 30 minutes [A]" = 2,
      "More than 30 minutes" = 3,
      "DK/Missing" = 9
    ),
    drinkingWater = "Time to source of drinking water",
    drinkingWater = c(
      "Users of improved drinking water sources" = 1,
      "Users of unimproved drinking water sources" = 2
    ),
    INDWS2 = "Percentage using basic drinking water services [1]"
    
  )
```

## 10.1.2 Tables

The general code process for creating the tables in R is as follows:
(there may be a more clever way to do this in one table command, but
this works for now)

Each `xtabs` command computes a contingency table We go group by group -
so e.g. starting off with contingency table of `HH6` (Area) vs. `WS1`
(drinking water source) , or for 1.2 Area vs `time`

This one `xtabs` command is a single building block in our SFR table, we
then stack these downwards using the `rbind` command in R, which
“rowbinds” blocks together.

Naturally - Using `rbind` to rowbind two objects together (table /
dataframe / list etc) requires exact same columns in each object,
similarly `cbind` (column binding) two objects requires exact same rows

We rowbind together downwards - `HH6` - Area, `HH7` Region, `helevel`
education level, and `windex5` wealth quintile. For the table here in
1.2, there’s an additional step of performing this sequence on a
filtered dataframe for `drinkingWater == 1`, then using `cbind` to bind
together the same table but for `drinkingWater == 2`

``` r
tab.improved.1.2 = xtabs(nn ~ as_factor(time), hh %>% filter(drinkingWater == 1)) %>% 
  rbind(xtabs(nn ~ HH6 + as_factor(time), hh %>% filter(drinkingWater == 1))) %>% 
  rbind(xtabs(nn ~ as_factor(HH7) + as_factor(time) , hh %>% filter(drinkingWater == 1))) %>%
  rbind(xtabs(nn ~ as_factor(helevel) + as_factor(time), hh %>% filter(drinkingWater == 1))) %>% 
  rbind(xtabs(nn ~ as_factor(windex5) + as_factor(time), hh %>% filter(drinkingWater == 1))) 


tab.unimproved.1.2 = xtabs(nn ~ as_factor(time), hh %>% filter(drinkingWater == 2)) %>% 
  rbind(xtabs(nn ~ HH6 + as_factor(time), hh %>% filter(drinkingWater == 2))) %>% 
  rbind(xtabs(nn ~ as_factor(HH7) + as_factor(time) , hh %>% filter(drinkingWater == 2))) %>%
  rbind(xtabs(nn ~ as_factor(helevel) + as_factor(time), hh %>% filter(drinkingWater == 2))) %>% 
  rbind(xtabs(nn ~ as_factor(windex5) + as_factor(time), hh %>% filter(drinkingWater == 2))) 


tab.1.2 <- cbind(tab.improved.1.2, tab.unimproved.1.2)
tab.1.2 <- tab.1.2 %>% cbind(Total = rowSums(tab.1.2))

# check
all(round(tab.1.2[, 9]) == round(df.tab$Count)) # gut check - good
```

    ## [1] FALSE

``` r
tab.1.2 <- apply(tab.1.2, 2, function(x) (x * 100) / tab.1.2[ , 9]) %>% cbind(round(df.tab$Count))

rownames(tab.1.2)[1] = "Total"
```

# SFR Table Ch10 WS 1.2

``` r
header1 = label(hh$time)

tab.1.2 %>% 
  kable(digits = 1, format.args = list(big.mark = ",", scientific = FALSE)) %>% 
  kable_styling(c("striped"), font_size = 12) %>% 
  pack_rows(label(hh.tab$HH6), 2, 3) %>% 
  pack_rows(label(hh.tab$HH7), 4, 10) %>% 
  pack_rows(label(hh.tab$helevel), 11, 15) %>% 
  pack_rows(label(hh.tab$windex5), 16, 20) %>% 
  add_header_above(c(" ", "Users of improved drinking water sources" = 4, 
                     "Users of unimproved drinking water sources" = 4,
                     " " = 2)) %>% 
  add_header_above(c(" ", "Time to source of drinking water" = 8, " " = 2))
```

<table class="table table-striped" style="font-size: 12px; margin-left: auto; margin-right: auto;">

<thead>

<tr>

<th style="border-bottom:hidden" colspan="1">

</th>

<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="8">

<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">

Time to source of drinking water

</div>

</th>

<th style="border-bottom:hidden" colspan="2">

</th>

</tr>

<tr>

<th style="border-bottom:hidden" colspan="1">

</th>

<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">

<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">

Users of improved drinking water sources

</div>

</th>

<th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">

<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">

Users of unimproved drinking water sources

</div>

</th>

<th style="border-bottom:hidden" colspan="2">

</th>

</tr>

<tr>

<th style="text-align:left;">

</th>

<th style="text-align:right;">

Water on premises

</th>

<th style="text-align:right;">

Up to and including 30 minutes \[A\]

</th>

<th style="text-align:right;">

More than 30 minutes

</th>

<th style="text-align:right;">

DK/Missing

</th>

<th style="text-align:right;">

Water on premises

</th>

<th style="text-align:right;">

Up to and including 30 minutes \[A\]

</th>

<th style="text-align:right;">

More than 30 minutes

</th>

<th style="text-align:right;">

DK/Missing

</th>

<th style="text-align:right;">

Total

</th>

<th style="text-align:right;">

</th>

</tr>

</thead>

<tbody>

<tr>

<td style="text-align:left;">

Total

</td>

<td style="text-align:right;">

98.8

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

1.2

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

218,005

</td>

</tr>

<tr grouplength="2">

<td colspan="11" style="border-bottom: 1px solid;">

<strong>Area</strong>

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

1

</td>

<td style="text-align:right;">

99.0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

1.0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

149,812

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

2

</td>

<td style="text-align:right;">

98.3

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

1.7

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

68,193

</td>

</tr>

<tr grouplength="7">

<td colspan="11" style="border-bottom: 1px solid;">

<strong>Region</strong>

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

DISTRICT TUNIS

</td>

<td style="text-align:right;">

98.7

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

1.3

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

61,975

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

NORD EST

</td>

<td style="text-align:right;">

99.5

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0.5

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

28,870

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

NORD OUEST

</td>

<td style="text-align:right;">

99.5

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0.5

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

19,871

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

CENTRE EST

</td>

<td style="text-align:right;">

98.5

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

1.5

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

60,218

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

CENTRE OUEST

</td>

<td style="text-align:right;">

98.0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

2.0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

24,540

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

SUD EST

</td>

<td style="text-align:right;">

99.9

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0.1

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

15,514

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

SUD OUEST

</td>

<td style="text-align:right;">

97.4

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

2.6

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

7,016

</td>

</tr>

<tr grouplength="5">

<td colspan="11" style="border-bottom: 1px solid;">

<strong>Education of household head</strong>

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Pre-primary or none

</td>

<td style="text-align:right;">

98.2

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

1.8

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

35,820

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Primary

</td>

<td style="text-align:right;">

98.9

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

1.1

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

84,062

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Secondary

</td>

<td style="text-align:right;">

98.8

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

1.2

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

72,315

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Higher

</td>

<td style="text-align:right;">

99.3

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0.7

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

25,388

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Missing/DK

</td>

<td style="text-align:right;">

100.0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0.0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

421

</td>

</tr>

<tr grouplength="5">

<td colspan="11" style="border-bottom: 1px solid;">

<strong>Wealth index quintile</strong>

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Poorest

</td>

<td style="text-align:right;">

98.1

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

1.9

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

44,520

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Second

</td>

<td style="text-align:right;">

99.2

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0.8

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

41,321

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Middle

</td>

<td style="text-align:right;">

98.9

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

1.1

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

43,641

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Fourth

</td>

<td style="text-align:right;">

98.6

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

1.4

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

43,091

</td>

</tr>

<tr>

<td style="text-align:left; padding-left: 2em;" indentlevel="1">

Richest

</td>

<td style="text-align:right;">

99.1

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0.9

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

100

</td>

<td style="text-align:right;">

45,431

</td>

</tr>

</tbody>

</table>
